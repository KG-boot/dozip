<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ApplyEstimate">
    <insert id="a_insert" parameterType="EstimateVO">
        insert into estimateT
        (est_num, mem_id, est_zoning, est_use, est_areaP, est_areaM, est_detail, est_detail01, est_detail02
        , est_detail03, est_detail04, est_detail05, est_detail06, est_detail07, est_detail08
        , est_bud, est_start, est_end, est_name, est_phone, est_desc, est_file)
        values(est_num_seq.nextval, #{mem_id, jdbcType = VARCHAR},#{est_zoning, jdbcType = VARCHAR},#{est_use, jdbcType = VARCHAR},#{est_areaP, jdbcType = VARCHAR},#{est_areaM, jdbcType = VARCHAR},#{est_detail, jdbcType = VARCHAR}
              ,#{est_detail01, jdbcType = VARCHAR},#{est_detail02, jdbcType = VARCHAR},#{est_detail03, jdbcType = VARCHAR},#{est_detail04, jdbcType = VARCHAR},#{est_detail05, jdbcType = VARCHAR},#{est_detail06, jdbcType = VARCHAR},#{est_detail07, jdbcType = VARCHAR}
              ,#{est_detail08, jdbcType = VARCHAR},#{est_bud, jdbcType = VARCHAR},#{est_start, jdbcType = VARCHAR},#{est_end, jdbcType = VARCHAR},#{est_name, jdbcType = VARCHAR},#{est_phone, jdbcType = VARCHAR},#{est_desc, jdbcType = VARCHAR},#{est_file, jdbcType = VARCHAR})
    </insert>

    <!--총 개수(해당 아이디의 작성 글 개수 확인 - 업체지정)-->
    <select id="p_count" resultType="int">
        select count(*) from estimateT where mem_id=#{mem_id} and (businessNum is not null)
    </select>

    <!--업체지정 견적신청 리스트-->
    <select id="p_list" resultType="EstimateVO">
        select * from (
        select rowNum r, est_num, mem_id, e.businessNum, est_check,est_use,
        est_detail,est_areaP,est_bud,est_date,est_dateEnd, p.businessName
        from (select*from estimateT where mem_id=#{mem_id} order by est_num desc) e, partnersT p
        where e.businessNum=p.businessNum(+) and (e.businessNum is not null)
        ) where r &gt;=#{startrow} and r &lt;=#{endrow}
    </select>


</mapper>